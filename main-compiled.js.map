{"version":3,"sources":["main.js"],"names":[],"mappings":"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","file":"main-compiled.js","sourcesContent":[";(function (window, document, d3, newssimData) {\n  'use strict';\n\n  // Monkey patching for ES7 array includes\n  Array.prototype.includes = function (element) {\n    return (this.indexOf(element) !== -1)\n  }\n\n  /**\n   * Get the frequencies of a keyword in a data on daily basis\n   * Days with no mentions are not included at all\n   * @param {string}    word: keyword to search\n   * @param {object}  data: database of content, arary of objects with content field\n   * @return {object}   in form of {20130202: 3,\n   *                                20130804: 2,\n   *                                ...}\n   */\n  function countWordByDay (word, data) {\n\n    let result = {}\n\n    for (let entry of data) {\n      if (entry.content.includes(word)) {\n        if (result[entry.publish_date]) {\n          result[entry.publish_date] += 1\n        } else {\n          result[entry.publish_date] = 1\n        }\n      }\n    }\n\n    return result\n  }\n\n  /**\n   * Extract parts (year, month, or day) from a date string in the form of 20120823\n   * @param {string} dateString\n   * @returns {string[]}\n   */\n  function separateDateComponents(dateString) {\n    return [dateString.slice(0, 4),\n            dateString.slice(4, 6),\n            dateString.slice(6, 8)]\n  }\n\n  /**\n   * Aggregate word frequencies by day, month, or year\n   * @param {object} wordCounts\n   * @param {string} period\n   */\n  function aggregatePeriod (wordCounts, period = 'month') {\n\n    let result = {}\n\n    let key, getKey\n    if (period === 'year') {\n      getKey = (date) => date.slice(0, 4)\n    } else if (period === 'month') {\n      getKey = (date) => date.slice(0, 6)\n    } else if (period === 'day') {\n      getKey = (date) => date.slice(0, 8)\n    } else {\n      throw new Error('un-implemented period: ', period)\n    }\n\n    for (let date in wordCounts) if (wordCounts.hasOwnProperty(date)) {\n      key = getKey(date)\n\n      if (result[key]) {\n        result[key] += wordCounts[date]\n      } else {\n        result[key] = wordCounts[date]\n      }\n    }\n\n    return result\n  }\n\n  /**\n   * Input n and return '0n' if n < 0\n   * @param n\n   */\n  function padDatePart(n) {\n    if (n < 10) {\n      return '0' + n\n    } else {\n      return '' + n\n    }\n  }\n\n  function getDaysInMonth(month) {\n    let thirtyDaysMonth = [4, 6, 9, 11]\n    let thirtyoneDaysMonth = [1, 3, 5, 7, 8, 10, 12]\n\n    if (thirtyDaysMonth.includes(month)) {\n      return 30\n    } else if (thirtyoneDaysMonth.includes(month)) {\n      return 31\n    } else {\n      return 28\n    }\n\n    //FIXME: Wrong results on leap years\n\n  }\n\n  /**\n   * Return the intervals of two dates, for example, input '201408' and '201502',\n   * you get ['201408', '201409', '201410', '201411', '201412', '201501', '201502']\n   * @param {string} startDate\n   * @param {string} endDate\n   */\n  function getDateIntervals (startDate, endDate) {\n    if (startDate.length !== endDate.length) {\n      throw new Error('startDate and endDate have different length; aborting...')\n    }\n\n    let result = [];\n    let startYear, startMonth, startDay, endYear, endMonth, endDay\n    switch (startDate.length) {\n\n      // Years, like '2011' to '2015\n      case 4:\n        for (let i = +startDate; i <= +endDate; i += 1) {\n          result.push(i.toString())\n        }\n        break;\n\n      // Months, like '201104' to '201501'\n      case 6:\n\n        startYear = +startDate.slice(0, 4)\n        startMonth = +startDate.slice(4, 6)\n        endYear = +endDate.slice(0, 4)\n        endMonth = +endDate.slice(4, 6)\n\n        for (let year = startYear; year <= endYear; year += 1) {\n          for (let month = 1; month <= 12; month += 1) {\n\n            // First year: skip months before startMonth\n            if ((year === startYear) && (month < startMonth)) {\n              continue\n            }\n\n            // Last year: skip months after endMonth\n            if ((year === endYear) && (month > endMonth)) {\n              continue\n            }\n\n            result.push(year.toString() + padDatePart(month.toString()))\n          }\n        }\n\n        break;\n\n      // Days, like '20120401' to '20130801'\n      case 8:\n        startYear = +startDate.slice(0, 4)\n        startMonth = +startDate.slice(4, 6)\n        startDay = +startDate.slice(6, 8)\n        endYear = +endDate.slice(0, 4)\n        endMonth = +endDate.slice(4, 6)\n        endDay = +endDate.slice(6, 8)\n\n        for (let year = startYear; year <= endYear; year += 1) {\n          for (let month = 1; month <= 12; month += 1) {\n            for (let day = 1; day <= getDaysInMonth(month); day += 1) {\n\n              // First year: skip months before startMonth\n              if ((year === startYear) && (month < startMonth)) {\n                continue\n              }\n\n              // Last year: skip months after endMonth\n              if ((year === endYear) && (month > endMonth)) {\n                continue\n              }\n\n              // First year and first month: skip days before startDay\n              if ((year === startYear) && (month === startMonth) && (day < startDay)) {\n                continue\n              }\n\n              // last year and last month: skip days after startDay\n              if ((year === endYear) && (month === endMonth) && (day > endDay)) {\n                continue\n              }\n\n              result.push('' + year + padDatePart(month) + padDatePart(day))\n            }\n          }\n        }\n\n        break;\n\n      default:\n        throw new Error(`Unrecognized date format: ${startDate}`)\n    }\n\n    return result\n  }\n\n  /**\n   * Transform data in form of {'201404': 32, '201408': 6} into an array like\n   * [{period: '201404', value: 32},\n   *  {period: '201406', value:  0},\n   *  {period: '201407', value:  0},\n   *  {period: '201408', value:  6}]\n   * @param {object} data\n   */\n  function transformToArray (data) {\n\n    let result = []\n\n    // Get the range of dates from data\n    let minDate = 'Z'\n    let maxDate = ''\n\n    for (let key in data) if (data.hasOwnProperty(key)) {\n      if (key < minDate) {\n        minDate = key\n      }\n\n      if (key > maxDate) {\n        maxDate = key\n      }\n    }\n\n    // Generate the array by pushing period-value pairs one by one\n    for (let period of getDateIntervals(minDate, maxDate)) {\n      if (data[period]) {\n        result.push({\n          period,\n          value: data[period]\n        })\n      } else {\n        result.push({\n          period,\n          value: 0\n        })\n      }\n    }\n\n    return result\n  }\n\n  /*================================================\n\n   END of data-processing helper functions;\n   START of DOM manipulation\n\n  =================================================*/\n\n  /**\n   * Get the period (e.g. 'year' or 'month'),\n   * chosen through radio option in the HTML form\n   * @returns {string}\n   */\n  function getChosenPeriod () {\n\n    const options = document.getElementsByName('period')\n    for (let i = 0; i < options.length; i += 1) {\n      if (options[i].checked) {\n        return options[i].value\n      }\n    }\n  }\n\n  const getMaxValue = (data) =>\n    data.reduce((max, entry) => entry.value > max ? entry.value : max , 0)\n\n  const padValue = (value, maxValue) => {\n    let result = value.toString()\n    while (result.length < maxValue.toString().length) {\n      result = '<span class=\"zeroPad\">0</span>' + result\n    }\n    return result\n  }\n\n  // Hide loading notice as the script has been fully loaded by now\n  const loadingNotice = document.getElementsByClassName('loading-notice')[0]\n  loadingNotice.parentNode.removeChild(loadingNotice)\n\n  // Get UI elements\n  const btnConfirm = document.getElementsByClassName('btnConfirm')[0]\n  const keywordInput = document.getElementsByClassName('keywordInput')[0]\n  const dataDisplay = document.getElementById('display')\n\n  btnConfirm.addEventListener('click', (event) => {\n\n    /**\n     *  Display the bars\n     */\n\n    let searchResults = transformToArray(aggregatePeriod(countWordByDay(keywordInput.value, newssimData), getChosenPeriod()))\n\n    let maxValue = getMaxValue(searchResults)\n\n    let barScale = d3.scale.linear()\n      .domain([0, maxValue])\n      .range([0, window.innerWidth / 2])\n\n    let selections = d3.select('#display').selectAll('p').data(searchResults,\n      d => d.period)\n\n    let newLines = selections.enter().append('p')\n    newLines.append('span')\n      .classed({\n        'description': true\n      })\n\n    newLines.append('div')\n      .classed({\n        \"barBody\": true\n      })\n\n    selections.selectAll('span.description')\n      .html(d => `[${d.period}: ${padValue(d.value, maxValue)}]`)\n\n    selections.selectAll('div.barBody')\n      .attr('data-keyword', keywordInput.value)\n      .attr('data-period', d => d.period)\n      .style('width', '0')\n      .transition()\n      .style('width', d => (barScale(d.value) + 'px'))\n\n    selections.exit().remove()\n\n  })\n\n  function prettifyLightboxContent (content, keyword, highlightClass) {\n    let result = content\n    let re\n\n    re = new RegExp('\\\\n', 'g')\n    result = result.replace(re, '<br>')\n\n    re = new RegExp('\\n', 'g')\n    result = result.replace(re, '<br>')\n\n    re = new RegExp('\\s', 'g')\n    result = result.replace(re, '<br>')\n\n    re = new RegExp(keyword, 'g')\n    result = result.replace(re, `<span class=${highlightClass}>${keyword}</span>`)\n\n    return result\n  }\n\n  function prettifyDate(s) {\n    return [s.slice(0, 4), s.slice(4, 6), s.slice(6, 8)].join('-')\n  }\n\n  function createRecordLightbox (data, keyword) {\n\n    let div = document.createElement('div')\n    div.className = 'lightbox'\n\n    let html = ''\n\n    for (let i = 0; i < data.length; i += 1) {\n      html += `\n        <div class=\"lightbox-content\">\n          <div>\n            <span>\n              [${i + 1}]\n            </span>\n            <time>\n              ${prettifyDate(data[i].publish_date)}\n            </time>\n            <a href=${data[i].url} target=\"_blank\">${data[i].url}</a>\n          </div>\n          <div class=\"lightbox-text\">\n            ${prettifyLightboxContent(data[i].content, keyword, 'lightbox-highlight')}\n          </div>\n        </div>\n      `\n    }\n\n    div.innerHTML = html\n    document.body.style.overflow = 'hidden'\n\n    document.addEventListener('keydown', event => {\n      if (event.keyCode === 27) {\n        div.style.display = 'none'\n        document.body.style.overflow = 'scroll'\n      }\n    })\n\n    return div\n  }\n\n  dataDisplay.addEventListener('click', event => {\n\n    /**\n     *   A bar in the bar-chart is clicked:\n     *   Display detailed information about that day\n     */\n\n    if (event.target.className === 'barBody') {\n\n      let keyword = event.target.dataset.keyword\n      let period = event.target.dataset.period\n\n      let relevantData = newssimData\n        .filter(record => record.content.includes(keyword))\n        .filter(record =>\n          record.publish_date.startsWith(period))\n\n      let lightbox = createRecordLightbox(relevantData, keyword)\n      document.body.appendChild(lightbox)\n    }\n\n\n  })\n\n})(window, window.document, window.d3, window.newssim_db)"]}